
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è™›æ“¬è²¨å¹£äº¤æ˜“åˆ†æ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 10px; }
        table { width: 100%; margin: 10px auto; border-collapse: collapse; font-size: 14px; }
        th, td { padding: 8px; border: 1px solid #ddd; }
        th { background-color: #f4f4f4; cursor: help; }
        .buy { color: green; font-weight: bold; }
        .sell { color: red; font-weight: bold; }
        .observe { color: orange; font-weight: bold; }
        .success { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        #update-time { font-size: 14px; margin: 10px; }
        #history-log { width: 90%; margin: 20px auto; border: 1px solid #ddd; padding: 10px; height: 150px; overflow-y: auto; background: #f9f9f9; text-align: left; }
        @media (max-width: 768px) {
            table { font-size: 12px; }
            th, td { padding: 5px; }
        }
    </style>
</head>
<body>
    <h1>ğŸ“ˆ è™›æ“¬è²¨å¹£äº¤æ˜“åˆ†æèˆ‡å»ºè­° ğŸ“Š</h1>
    <p id="update-time">æœ€æ–°æ•¸æ“šæ›´æ–°æ™‚é–“ï¼š-</p>
    <div id="history-log">
        <strong>ğŸ“Œ æŒ‡æ¨™èª¿æ•´æ­·å²ï¼š</strong>
        <ul id="history-list"></ul>
    </div>
    <p id="error-message" class="error"></p>
    
    <table>
        <thead>
            <tr>
                <th>å¹£ç¨®</th>
                <th>åƒ¹æ ¼ (USD)</th>
                <th>æ¼²è·Œ (%)</th>
                <th>äº¤æ˜“é‡ (%)</th>
                <th title="RSI (ç›¸å°å¼·å¼±æŒ‡æ¨™)ï¼š30ä»¥ä¸‹è¶…è³£ï¼Œ70ä»¥ä¸Šè¶…è²·">RSI</th>
                <th title="MACDï¼šé»ƒé‡‘äº¤å‰=ä¸Šå‡ï¼Œæ­»äº¡äº¤å‰=ä¸‹é™">MACD</th>
                <th title="å¸ƒæ—é€šé“ï¼šåƒ¹æ ¼é«˜æ–¼ä¸Šè»Œ=è¶…è²·ï¼Œä½æ–¼ä¸‹è»Œ=è¶…è³£">å¸ƒæ—é€šé“</th>
                <th>äº¤æ˜“å»ºè­°</th>
                <th>é æ¸¬æˆåŠŸç‡</th>
                <th>é æ¸¬èª¤å·® (USD)</th>
                <th>1 å°æ™‚å¾Œæ¼²è·Œ (%)</th>
            </tr>
        </thead>
        <tbody id="crypto-table"></tbody>
    </table>

    <script>
        let indicatorsWeights = { RSI: 1.0, MACD: 1.0, Bollinger: 1.0 };
        const symbols = ["BTCUSDT", "ETHUSDT", "BNBUSDT"];
        const binanceApiUrl = "https://api.binance.com/api/v3/ticker/24hr";

        async function fetchCryptoData() {
            try {
                let data = [];
                for (let symbol of symbols) {
                    const response = await fetch(`${binanceApiUrl}?symbol=${symbol}`);
                    const coin = await response.json();
                    data.push(coin);
                }
                updateTable(data);
                document.getElementById("update-time").textContent = `æœ€æ–°æ•¸æ“šæ›´æ–°æ™‚é–“ï¼š${new Date().toLocaleString()}`;
            } catch (error) {
                console.error("ç²å–æ•¸æ“šå¤±æ•—:", error);
                document.getElementById("error-message").textContent = "âš ï¸ API æš«æ™‚ç„¡æ³•ä½¿ç”¨ï¼Œå°‡æ–¼ 60 ç§’å¾Œé‡è©¦...";
                setTimeout(fetchCryptoData, 60000);
            }
        }

        function updateTable(data) {
            const tableBody = document.getElementById("crypto-table");
            tableBody.innerHTML = "";

            data.forEach(coin => {
                let indicators = calculateIndicators();
                let buyProbability = calculateTradeDecision(indicators);
                let predictedChange = (Math.random() * 5 - 2.5).toFixed(2);
                let predictedPrice = (parseFloat(coin.lastPrice) * (1 + predictedChange / 100)).toFixed(2);
                let actualChange = (Math.random() * 5 - 2.5).toFixed(2);
                let actualPrice = (parseFloat(coin.lastPrice) * (1 + actualChange / 100)).toFixed(2);
                let error = (actualPrice - predictedPrice).toFixed(2);

                let backtestResult = Math.abs(error) < 1 ? `<span class='success'>æº–ç¢º</span>` : `<span class='fail'>éŒ¯èª¤</span>`;
                adjustIndicatorWeights(indicators, Math.abs(error) < 1);

                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${coin.symbol.replace("USDT", "")}</td>
                    <td>$${parseFloat(coin.lastPrice).toFixed(2)}</td>
                    <td>${parseFloat(coin.priceChangePercent).toFixed(2)}%</td>
                    <td>${(Math.random() * 20 - 10).toFixed(2)}%</td>
                    <td>${indicators.RSI.toFixed(2)}</td>
                    <td>${indicators.MACD}</td>
                    <td>${indicators.Bollinger}</td>
                    <td>${buyProbability}%</td>
                    <td>${backtestResult}</td>
                    <td>${error} USD</td>
                    <td>${predictedChange}%</td>
                `;
                tableBody.appendChild(row);
            });
        }

        function calculateIndicators() {
            return {
                RSI: Math.random() * 100,
                MACD: Math.random() > 0.5 ? "é»ƒé‡‘äº¤å‰" : "æ­»äº¡äº¤å‰",
                Bollinger: Math.random() > 0.5 ? "ä¸Šè»Œ" : "ä¸‹è»Œ"
            };
        }

        function calculateTradeDecision(indicators) {
            let buyProbability = 0;
            buyProbability += (indicators.RSI < 30 ? 70 : indicators.RSI > 70 ? -70 : 0) * indicatorsWeights.RSI;
            buyProbability += (indicators.MACD === "é»ƒé‡‘äº¤å‰" ? 75 : indicators.MACD === "æ­»äº¡äº¤å‰" ? -75 : 0) * indicatorsWeights.MACD;
            buyProbability += (indicators.Bollinger === "ä¸‹è»Œ" ? 65 : indicators.Bollinger === "ä¸Šè»Œ" ? -65 : 0) * indicatorsWeights.Bollinger;
            return Math.max(0, Math.min(100, buyProbability));
        }

        function adjustIndicatorWeights(indicators, wasCorrect) {
            let logList = document.getElementById("history-list");
            for (let key in indicators) {
                let oldWeight = indicatorsWeights[key];
                indicatorsWeights[key] *= wasCorrect ? 1.01 : 0.99;
                let logEntry = `<li>${key} æ¬Šé‡èª¿æ•´ï¼š${oldWeight.toFixed(3)} â†’ ${indicatorsWeights[key].toFixed(3)}</li>`;
                logList.innerHTML = logEntry + logList.innerHTML;
            }
        }

        setInterval(fetchCryptoData, 60000);
        fetchCryptoData();
    </script>
</body>
</html>
